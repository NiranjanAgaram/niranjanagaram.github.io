<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="MLOps: Machine Learning Deployment Strategies">
    <meta name="author" content="Niranjan Agaram">
    <meta name="robots" content="index, follow">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="post">
    <meta property="og:url" content="http://localhost:4009/2023/04/20/mlops-deployment-strategies/">
    <meta property="og:title" content="MLOps: Machine Learning Deployment Strategies">
    <meta property="og:description" content="MLOps: Machine Learning Deployment Strategies">
    <meta property="og:image" content="http://localhost:4009/assets/images/og-image.svg">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="http://localhost:4009/2023/04/20/mlops-deployment-strategies/">
    <meta property="twitter:title" content="MLOps: Machine Learning Deployment Strategies">
    <meta property="twitter:description" content="MLOps: Machine Learning Deployment Strategies">
    <meta property="twitter:image" content="http://localhost:4009/assets/images/og-image.svg">
    
    <!-- Enhanced Structured Data -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "name": "Niranjan Agaram",
      "jobTitle": "AI & Data Engineering Consultant",
      "description": "10+ years evolving from data engineering to agentic AI systems across healthcare, retail, marketing, and real estate",
      "url": "http://localhost:4009",
      "sameAs": [
        "https://linkedin.com/in/niranjan-agaram",
        "https://github.com/niranjanagaram"
      ],
      "knowsAbout": [
        "Artificial Intelligence",
        "Data Engineering", 
        "Machine Learning",
        "LangChain",
        "CrewAI",
        "FastAPI",
        "Python",
        "SAS",
        "Multi-Agent Systems"
      ],
      "hasOccupation": {
        "@type": "Occupation",
        "name": "AI Consultant",
        "occupationLocation": {
          "@type": "Country",
          "name": "India"
        }
      }
    }
    </script>
    
    <title>MLOps: Machine Learning Deployment Strategies</title>
    <link rel="canonical" href="http://localhost:4009/2023/04/20/mlops-deployment-strategies/">
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="stylesheet" href="/assets/css/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#3b82f6">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Niranjan AI">
    <script src="/assets/js/main.js" defer></script>
    <script src="/assets/js/search.js" defer></script>
    <script src="/assets/js/performance.js" defer></script>
    
    <!-- Analytics -->
    
</head>
<body>

    <div class="bg-orb orb-1" aria-hidden="true"></div>
    <div class="bg-orb orb-2" aria-hidden="true"></div>
    
    <!-- Progress Bar -->
    <div class="reading-progress" id="reading-progress" aria-hidden="true"></div>
    
    <header role="banner">
        <div class="container">
            <h1><a href="/" aria-label="Home - Niranjan's AI Insights">Niranjan's AI Insights</a></h1>
            <p>Enterprise AI solutions, agentic systems, and intelligent automation insights from a senior data engineer</p>
            
            <!-- Search -->
            <div class="search-container">
                <input type="search" id="search-input" placeholder="Search posts..." aria-label="Search blog posts">
                <div id="search-results" class="search-results" aria-live="polite"></div>
            </div>
            
            <nav role="navigation" aria-label="Main navigation">
                <div class="nav-links">
                    <a href="/" >Home</a>
                    <a href="/posts" >Posts</a>
                    <a href="/services" >Services</a>
                    <a href="/about" >About</a>
                    <a href="/contact" >Contact</a>
                    <a href="/archive" >Archive</a>
                </div>
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle dark/light mode"></button>
            </nav>
        </div>
    </header>
    
    <main id="main-content" class="container" role="main">
        <article itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    <h1 itemprop="headline">MLOps: Machine Learning Deployment Strategies</h1>
    <div class="post-meta">
      <time datetime="2023-04-20T00:00:00+05:30" itemprop="datePublished">
        April 20, 2023
      </time>
      
      <span class="reading-time">📖 18 min read</span>
    </div>
    
    <div class="tags">
      
        <span class="tag" itemprop="keywords">mlops</span>
      
        <span class="tag" itemprop="keywords">machine-learning</span>
      
        <span class="tag" itemprop="keywords">deployment</span>
      
        <span class="tag" itemprop="keywords">model-serving</span>
      
        <span class="tag" itemprop="keywords">kubernetes</span>
      
        <span class="tag" itemprop="keywords">docker</span>
      
    </div>
    
  </header>

  <div itemprop="articleBody">
    <h1 id="mlops-machine-learning-deployment-strategies">MLOps: Machine Learning Deployment Strategies</h1>

<p>Moving machine learning models from development to production is one of the biggest challenges in ML projects. MLOps bridges this gap by applying DevOps principles to machine learning workflows, ensuring reliable, scalable, and maintainable ML systems.</p>

<h2 id="the-mlops-challenge">The MLOps Challenge</h2>

<p>Traditional software deployment differs significantly from ML model deployment:</p>

<ul>
  <li><strong>Data Dependencies</strong>: Models depend on specific data distributions</li>
  <li><strong>Model Drift</strong>: Performance degrades over time as data changes</li>
  <li><strong>Experimentation</strong>: Constant need for A/B testing and model comparison</li>
  <li><strong>Reproducibility</strong>: Complex dependencies and environment requirements</li>
  <li><strong>Monitoring</strong>: Need to track both technical and business metrics</li>
</ul>

<h2 id="mlops-architecture-overview">MLOps Architecture Overview</h2>

<h3 id="core-components">Core Components</h3>
<ol>
  <li><strong>Model Training Pipeline</strong>: Automated training and validation</li>
  <li><strong>Model Registry</strong>: Centralized model versioning and metadata</li>
  <li><strong>Deployment Pipeline</strong>: Automated model deployment</li>
  <li><strong>Monitoring System</strong>: Performance and drift detection</li>
  <li><strong>Feature Store</strong>: Centralized feature management</li>
</ol>

<h2 id="model-packaging-and-containerization">Model Packaging and Containerization</h2>

<h3 id="docker-based-model-serving">Docker-based Model Serving</h3>
<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Dockerfile for ML model serving</span>
<span class="k">FROM</span><span class="s"> python:3.9-slim</span>

<span class="k">WORKDIR</span><span class="s"> /app</span>

<span class="c"># Install system dependencies</span>
<span class="k">RUN </span>apt-get update <span class="o">&amp;&amp;</span> apt-get <span class="nb">install</span> <span class="nt">-y</span> <span class="se">\
</span>    gcc <span class="se">\
</span>    <span class="o">&amp;&amp;</span> <span class="nb">rm</span> <span class="nt">-rf</span> /var/lib/apt/lists/<span class="k">*</span>

<span class="c"># Copy requirements and install Python dependencies</span>
<span class="k">COPY</span><span class="s"> requirements.txt .</span>
<span class="k">RUN </span>pip <span class="nb">install</span> <span class="nt">--no-cache-dir</span> <span class="nt">-r</span> requirements.txt

<span class="c"># Copy model artifacts and application code</span>
<span class="k">COPY</span><span class="s"> model/ ./model/</span>
<span class="k">COPY</span><span class="s"> src/ ./src/</span>
<span class="k">COPY</span><span class="s"> app.py .</span>

<span class="c"># Expose port</span>
<span class="k">EXPOSE</span><span class="s"> 8000</span>

<span class="c"># Health check</span>
<span class="k">HEALTHCHECK</span><span class="s"> --interval=30s --timeout=30s --start-period=5s --retries=3 \</span>
    CMD curl -f http://localhost:8000/health || exit 1

<span class="c"># Run the application</span>
<span class="k">CMD</span><span class="s"> ["uvicorn", "app:app", "--host", "0.0.0.0", "--port", "8000"]</span>
</code></pre></div></div>

<h3 id="fastapi-model-serving-application">FastAPI Model Serving Application</h3>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">fastapi</span> <span class="kn">import</span> <span class="n">FastAPI</span><span class="p">,</span> <span class="n">HTTPException</span>
<span class="kn">from</span> <span class="nn">pydantic</span> <span class="kn">import</span> <span class="n">BaseModel</span>
<span class="kn">import</span> <span class="nn">joblib</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Any</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>

<span class="c1"># Configure logging
</span><span class="n">logging</span><span class="p">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="p">.</span><span class="n">INFO</span><span class="p">)</span>
<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="p">.</span><span class="n">getLogger</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">FastAPI</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">"ML Model API"</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="s">"1.0.0"</span><span class="p">)</span>

<span class="c1"># Load model at startup
</span><span class="n">model</span> <span class="o">=</span> <span class="bp">None</span>
<span class="n">feature_columns</span> <span class="o">=</span> <span class="bp">None</span>

<span class="o">@</span><span class="n">app</span><span class="p">.</span><span class="n">on_event</span><span class="p">(</span><span class="s">"startup"</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">load_model</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">model</span><span class="p">,</span> <span class="n">feature_columns</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">joblib</span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">"model/model.pkl"</span><span class="p">)</span>
        <span class="n">feature_columns</span> <span class="o">=</span> <span class="n">joblib</span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">"model/feature_columns.pkl"</span><span class="p">)</span>
        <span class="n">logger</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">"Model loaded successfully"</span><span class="p">)</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="p">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s">"Failed to load model: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        <span class="k">raise</span>

<span class="k">class</span> <span class="nc">PredictionRequest</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">features</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
    <span class="n">model_version</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s">"v1.0"</span>

<span class="k">class</span> <span class="nc">PredictionResponse</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">prediction</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">probability</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">model_version</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">timestamp</span><span class="p">:</span> <span class="nb">str</span>

<span class="o">@</span><span class="n">app</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="s">"/predict"</span><span class="p">,</span> <span class="n">response_model</span><span class="o">=</span><span class="n">PredictionResponse</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="n">request</span><span class="p">:</span> <span class="n">PredictionRequest</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Validate input features
</span>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">col</span> <span class="ow">in</span> <span class="n">request</span><span class="p">.</span><span class="n">features</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">feature_columns</span><span class="p">):</span>
            <span class="n">missing_cols</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">feature_columns</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="n">features</span><span class="p">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="k">raise</span> <span class="n">HTTPException</span><span class="p">(</span>
                <span class="n">status_code</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> 
                <span class="n">detail</span><span class="o">=</span><span class="sa">f</span><span class="s">"Missing features: </span><span class="si">{</span><span class="n">missing_cols</span><span class="si">}</span><span class="s">"</span>
            <span class="p">)</span>
        
        <span class="c1"># Prepare input data
</span>        <span class="n">input_data</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">request</span><span class="p">.</span><span class="n">features</span><span class="p">])[</span><span class="n">feature_columns</span><span class="p">]</span>
        
        <span class="c1"># Make prediction
</span>        <span class="n">prediction</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">input_data</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        
        <span class="c1"># Get prediction probabilities if available
</span>        <span class="n">probabilities</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s">'predict_proba'</span><span class="p">):</span>
            <span class="n">probabilities</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">input_data</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="n">tolist</span><span class="p">()</span>
        
        <span class="c1"># Log prediction for monitoring
</span>        <span class="n">logger</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s">"Prediction made: </span><span class="si">{</span><span class="n">prediction</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">PredictionResponse</span><span class="p">(</span>
            <span class="n">prediction</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">prediction</span><span class="p">),</span>
            <span class="n">probability</span><span class="o">=</span><span class="n">probabilities</span><span class="p">,</span>
            <span class="n">model_version</span><span class="o">=</span><span class="n">request</span><span class="p">.</span><span class="n">model_version</span><span class="p">,</span>
            <span class="n">timestamp</span><span class="o">=</span><span class="n">datetime</span><span class="p">.</span><span class="n">now</span><span class="p">().</span><span class="n">isoformat</span><span class="p">()</span>
        <span class="p">)</span>
        
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="p">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s">"Prediction error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">HTTPException</span><span class="p">(</span><span class="n">status_code</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">detail</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>

<span class="o">@</span><span class="n">app</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">"/health"</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">health_check</span><span class="p">():</span>
    <span class="k">return</span> <span class="p">{</span><span class="s">"status"</span><span class="p">:</span> <span class="s">"healthy"</span><span class="p">,</span> <span class="s">"model_loaded"</span><span class="p">:</span> <span class="n">model</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">}</span>

<span class="o">@</span><span class="n">app</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">"/model/info"</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">model_info</span><span class="p">():</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="s">"model_type"</span><span class="p">:</span> <span class="nb">type</span><span class="p">(</span><span class="n">model</span><span class="p">).</span><span class="n">__name__</span><span class="p">,</span>
        <span class="s">"feature_count"</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">feature_columns</span><span class="p">),</span>
        <span class="s">"features"</span><span class="p">:</span> <span class="n">feature_columns</span>
    <span class="p">}</span>
</code></pre></div></div>

<h2 id="kubernetes-deployment">Kubernetes Deployment</h2>

<h3 id="model-deployment-manifest">Model Deployment Manifest</h3>
<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">apps/v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Deployment</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">ml-model-deployment</span>
  <span class="na">labels</span><span class="pi">:</span>
    <span class="na">app</span><span class="pi">:</span> <span class="s">ml-model</span>
    <span class="na">version</span><span class="pi">:</span> <span class="s">v1.0</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">replicas</span><span class="pi">:</span> <span class="m">3</span>
  <span class="na">selector</span><span class="pi">:</span>
    <span class="na">matchLabels</span><span class="pi">:</span>
      <span class="na">app</span><span class="pi">:</span> <span class="s">ml-model</span>
  <span class="na">template</span><span class="pi">:</span>
    <span class="na">metadata</span><span class="pi">:</span>
      <span class="na">labels</span><span class="pi">:</span>
        <span class="na">app</span><span class="pi">:</span> <span class="s">ml-model</span>
        <span class="na">version</span><span class="pi">:</span> <span class="s">v1.0</span>
    <span class="na">spec</span><span class="pi">:</span>
      <span class="na">containers</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">ml-model</span>
        <span class="na">image</span><span class="pi">:</span> <span class="s">your-registry/ml-model:v1.0</span>
        <span class="na">ports</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">containerPort</span><span class="pi">:</span> <span class="m">8000</span>
        <span class="na">env</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">MODEL_VERSION</span>
          <span class="na">value</span><span class="pi">:</span> <span class="s2">"</span><span class="s">v1.0"</span>
        <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">LOG_LEVEL</span>
          <span class="na">value</span><span class="pi">:</span> <span class="s2">"</span><span class="s">INFO"</span>
        <span class="na">resources</span><span class="pi">:</span>
          <span class="na">requests</span><span class="pi">:</span>
            <span class="na">memory</span><span class="pi">:</span> <span class="s2">"</span><span class="s">512Mi"</span>
            <span class="na">cpu</span><span class="pi">:</span> <span class="s2">"</span><span class="s">250m"</span>
          <span class="na">limits</span><span class="pi">:</span>
            <span class="na">memory</span><span class="pi">:</span> <span class="s2">"</span><span class="s">1Gi"</span>
            <span class="na">cpu</span><span class="pi">:</span> <span class="s2">"</span><span class="s">500m"</span>
        <span class="na">livenessProbe</span><span class="pi">:</span>
          <span class="na">httpGet</span><span class="pi">:</span>
            <span class="na">path</span><span class="pi">:</span> <span class="s">/health</span>
            <span class="na">port</span><span class="pi">:</span> <span class="m">8000</span>
          <span class="na">initialDelaySeconds</span><span class="pi">:</span> <span class="m">30</span>
          <span class="na">periodSeconds</span><span class="pi">:</span> <span class="m">10</span>
        <span class="na">readinessProbe</span><span class="pi">:</span>
          <span class="na">httpGet</span><span class="pi">:</span>
            <span class="na">path</span><span class="pi">:</span> <span class="s">/health</span>
            <span class="na">port</span><span class="pi">:</span> <span class="m">8000</span>
          <span class="na">initialDelaySeconds</span><span class="pi">:</span> <span class="m">5</span>
          <span class="na">periodSeconds</span><span class="pi">:</span> <span class="m">5</span>
<span class="nn">---</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Service</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">ml-model-service</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">selector</span><span class="pi">:</span>
    <span class="na">app</span><span class="pi">:</span> <span class="s">ml-model</span>
  <span class="na">ports</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">protocol</span><span class="pi">:</span> <span class="s">TCP</span>
    <span class="na">port</span><span class="pi">:</span> <span class="m">80</span>
    <span class="na">targetPort</span><span class="pi">:</span> <span class="m">8000</span>
  <span class="na">type</span><span class="pi">:</span> <span class="s">LoadBalancer</span>
</code></pre></div></div>

<h2 id="cicd-pipeline-for-ml-models">CI/CD Pipeline for ML Models</h2>

<h3 id="github-actions-workflow">GitHub Actions Workflow</h3>
<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">name</span><span class="pi">:</span> <span class="s">ML Model CI/CD</span>

<span class="na">on</span><span class="pi">:</span>
  <span class="na">push</span><span class="pi">:</span>
    <span class="na">branches</span><span class="pi">:</span> <span class="pi">[</span><span class="nv">main</span><span class="pi">]</span>
  <span class="na">pull_request</span><span class="pi">:</span>
    <span class="na">branches</span><span class="pi">:</span> <span class="pi">[</span><span class="nv">main</span><span class="pi">]</span>

<span class="na">env</span><span class="pi">:</span>
  <span class="na">REGISTRY</span><span class="pi">:</span> <span class="s">ghcr.io</span>
  <span class="na">IMAGE_NAME</span><span class="pi">:</span> <span class="s">$/ml-model</span>

<span class="na">jobs</span><span class="pi">:</span>
  <span class="na">test</span><span class="pi">:</span>
    <span class="na">runs-on</span><span class="pi">:</span> <span class="s">ubuntu-latest</span>
    <span class="na">steps</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">uses</span><span class="pi">:</span> <span class="s">actions/checkout@v3</span>
    
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Set up Python</span>
      <span class="na">uses</span><span class="pi">:</span> <span class="s">actions/setup-python@v4</span>
      <span class="na">with</span><span class="pi">:</span>
        <span class="na">python-version</span><span class="pi">:</span> <span class="s1">'</span><span class="s">3.9'</span>
    
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Install dependencies</span>
      <span class="na">run</span><span class="pi">:</span> <span class="pi">|</span>
        <span class="s">pip install -r requirements.txt</span>
        <span class="s">pip install pytest pytest-cov</span>
    
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Run tests</span>
      <span class="na">run</span><span class="pi">:</span> <span class="pi">|</span>
        <span class="s">pytest tests/ --cov=src/ --cov-report=xml</span>
    
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Model validation</span>
      <span class="na">run</span><span class="pi">:</span> <span class="pi">|</span>
        <span class="s">python scripts/validate_model.py</span>
  
  <span class="na">build-and-deploy</span><span class="pi">:</span>
    <span class="na">needs</span><span class="pi">:</span> <span class="s">test</span>
    <span class="na">runs-on</span><span class="pi">:</span> <span class="s">ubuntu-latest</span>
    <span class="na">if</span><span class="pi">:</span> <span class="s">github.ref == 'refs/heads/main'</span>
    
    <span class="na">steps</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">uses</span><span class="pi">:</span> <span class="s">actions/checkout@v3</span>
    
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Log in to Container Registry</span>
      <span class="na">uses</span><span class="pi">:</span> <span class="s">docker/login-action@v2</span>
      <span class="na">with</span><span class="pi">:</span>
        <span class="na">registry</span><span class="pi">:</span> <span class="s">$</span>
        <span class="na">username</span><span class="pi">:</span> <span class="s">$</span>
        <span class="na">password</span><span class="pi">:</span> <span class="s">$</span>
    
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Build and push Docker image</span>
      <span class="na">uses</span><span class="pi">:</span> <span class="s">docker/build-push-action@v4</span>
      <span class="na">with</span><span class="pi">:</span>
        <span class="na">context</span><span class="pi">:</span> <span class="s">.</span>
        <span class="na">push</span><span class="pi">:</span> <span class="no">true</span>
        <span class="na">tags</span><span class="pi">:</span> <span class="s">$/$:$</span>
    
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Deploy to staging</span>
      <span class="na">run</span><span class="pi">:</span> <span class="pi">|</span>
        <span class="s"># Update Kubernetes deployment</span>
        <span class="s">kubectl set image deployment/ml-model-deployment \</span>
          <span class="s">ml-model=$/$:$</span>
</code></pre></div></div>

<h2 id="model-monitoring-and-observability">Model Monitoring and Observability</h2>

<h3 id="prometheus-metrics">Prometheus Metrics</h3>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">prometheus_client</span> <span class="kn">import</span> <span class="n">Counter</span><span class="p">,</span> <span class="n">Histogram</span><span class="p">,</span> <span class="n">Gauge</span><span class="p">,</span> <span class="n">generate_latest</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="c1"># Define metrics
</span><span class="n">prediction_requests</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="s">'ml_prediction_requests_total'</span><span class="p">,</span> <span class="s">'Total prediction requests'</span><span class="p">)</span>
<span class="n">prediction_latency</span> <span class="o">=</span> <span class="n">Histogram</span><span class="p">(</span><span class="s">'ml_prediction_duration_seconds'</span><span class="p">,</span> <span class="s">'Prediction latency'</span><span class="p">)</span>
<span class="n">model_accuracy</span> <span class="o">=</span> <span class="n">Gauge</span><span class="p">(</span><span class="s">'ml_model_accuracy'</span><span class="p">,</span> <span class="s">'Current model accuracy'</span><span class="p">)</span>
<span class="n">data_drift_score</span> <span class="o">=</span> <span class="n">Gauge</span><span class="p">(</span><span class="s">'ml_data_drift_score'</span><span class="p">,</span> <span class="s">'Data drift detection score'</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">ModelMonitor</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">prediction_count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">accuracy_window</span> <span class="o">=</span> <span class="p">[]</span>
        
    <span class="k">def</span> <span class="nf">record_prediction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prediction_time</span><span class="p">,</span> <span class="n">actual_value</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">predicted_value</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="c1"># Record metrics
</span>        <span class="n">prediction_requests</span><span class="p">.</span><span class="n">inc</span><span class="p">()</span>
        <span class="n">prediction_latency</span><span class="p">.</span><span class="n">observe</span><span class="p">(</span><span class="n">prediction_time</span><span class="p">)</span>
        
        <span class="c1"># Track accuracy if ground truth is available
</span>        <span class="k">if</span> <span class="n">actual_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">predicted_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">is_correct</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">actual_value</span> <span class="o">-</span> <span class="n">predicted_value</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.1</span>  <span class="c1"># Threshold for regression
</span>            <span class="bp">self</span><span class="p">.</span><span class="n">accuracy_window</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">is_correct</span><span class="p">)</span>
            
            <span class="c1"># Keep only recent predictions for accuracy calculation
</span>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">accuracy_window</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1000</span><span class="p">:</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">accuracy_window</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">accuracy_window</span><span class="p">[</span><span class="o">-</span><span class="mi">1000</span><span class="p">:]</span>
            
            <span class="c1"># Update accuracy metric
</span>            <span class="n">current_accuracy</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">accuracy_window</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">accuracy_window</span><span class="p">)</span>
            <span class="n">model_accuracy</span><span class="p">.</span><span class="nb">set</span><span class="p">(</span><span class="n">current_accuracy</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">detect_data_drift</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">current_features</span><span class="p">,</span> <span class="n">reference_features</span><span class="p">):</span>
        <span class="s">"""Simple data drift detection using statistical tests."""</span>
        <span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>
        
        <span class="n">drift_scores</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="n">current_features</span><span class="p">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">feature</span> <span class="ow">in</span> <span class="n">reference_features</span><span class="p">.</span><span class="n">columns</span><span class="p">:</span>
                <span class="c1"># Kolmogorov-Smirnov test
</span>                <span class="n">statistic</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">stats</span><span class="p">.</span><span class="n">ks_2samp</span><span class="p">(</span>
                    <span class="n">current_features</span><span class="p">[</span><span class="n">feature</span><span class="p">].</span><span class="n">dropna</span><span class="p">(),</span>
                    <span class="n">reference_features</span><span class="p">[</span><span class="n">feature</span><span class="p">].</span><span class="n">dropna</span><span class="p">()</span>
                <span class="p">)</span>
                <span class="n">drift_scores</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">statistic</span><span class="p">)</span>
        
        <span class="n">avg_drift_score</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">drift_scores</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">drift_scores</span><span class="p">)</span> <span class="k">if</span> <span class="n">drift_scores</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="n">data_drift_score</span><span class="p">.</span><span class="nb">set</span><span class="p">(</span><span class="n">avg_drift_score</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">avg_drift_score</span>

<span class="c1"># Add to FastAPI app
</span><span class="o">@</span><span class="n">app</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">"/metrics"</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">metrics</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="n">generate_latest</span><span class="p">(),</span> <span class="n">media_type</span><span class="o">=</span><span class="s">"text/plain"</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="model-performance-tracking">Model Performance Tracking</h3>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">mlflow</span>
<span class="kn">import</span> <span class="nn">mlflow.sklearn</span>
<span class="kn">from</span> <span class="nn">mlflow.tracking</span> <span class="kn">import</span> <span class="n">MlflowClient</span>

<span class="k">class</span> <span class="nc">ModelTracker</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">experiment_name</span><span class="o">=</span><span class="s">"production_model"</span><span class="p">):</span>
        <span class="n">mlflow</span><span class="p">.</span><span class="n">set_experiment</span><span class="p">(</span><span class="n">experiment_name</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">client</span> <span class="o">=</span> <span class="n">MlflowClient</span><span class="p">()</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">run_id</span> <span class="o">=</span> <span class="bp">None</span>
    
    <span class="k">def</span> <span class="nf">start_run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_version</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">run</span> <span class="o">=</span> <span class="n">mlflow</span><span class="p">.</span><span class="n">start_run</span><span class="p">(</span>
            <span class="n">tags</span><span class="o">=</span><span class="p">{</span><span class="s">"model_version"</span><span class="p">:</span> <span class="n">model_version</span><span class="p">,</span> <span class="s">"environment"</span><span class="p">:</span> <span class="s">"production"</span><span class="p">}</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">run_id</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">run</span><span class="p">.</span><span class="n">info</span><span class="p">.</span><span class="n">run_id</span>
    
    <span class="k">def</span> <span class="nf">log_prediction_metrics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">predictions</span><span class="p">,</span> <span class="n">actuals</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">mean_absolute_error</span><span class="p">,</span> <span class="n">r2_score</span>
        
        <span class="n">mse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">actuals</span><span class="p">,</span> <span class="n">predictions</span><span class="p">)</span>
        <span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">actuals</span><span class="p">,</span> <span class="n">predictions</span><span class="p">)</span>
        <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">actuals</span><span class="p">,</span> <span class="n">predictions</span><span class="p">)</span>
        
        <span class="n">mlflow</span><span class="p">.</span><span class="n">log_metrics</span><span class="p">({</span>
            <span class="s">"mse"</span><span class="p">:</span> <span class="n">mse</span><span class="p">,</span>
            <span class="s">"mae"</span><span class="p">:</span> <span class="n">mae</span><span class="p">,</span>
            <span class="s">"r2_score"</span><span class="p">:</span> <span class="n">r2</span><span class="p">,</span>
            <span class="s">"prediction_count"</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span>
        <span class="p">})</span>
    
    <span class="k">def</span> <span class="nf">log_data_drift</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">drift_score</span><span class="p">):</span>
        <span class="n">mlflow</span><span class="p">.</span><span class="n">log_metric</span><span class="p">(</span><span class="s">"data_drift_score"</span><span class="p">,</span> <span class="n">drift_score</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">drift_score</span> <span class="o">&gt;</span> <span class="mf">0.1</span><span class="p">:</span>  <span class="c1"># Threshold for significant drift
</span>            <span class="n">mlflow</span><span class="p">.</span><span class="n">log_param</span><span class="p">(</span><span class="s">"drift_alert"</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">end_run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">run_id</span><span class="p">:</span>
            <span class="n">mlflow</span><span class="p">.</span><span class="n">end_run</span><span class="p">()</span>
</code></pre></div></div>

<h2 id="ab-testing-for-models">A/B Testing for Models</h2>

<h3 id="model-comparison-framework">Model Comparison Framework</h3>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">random</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Any</span>

<span class="k">class</span> <span class="nc">ModelABTester</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">models</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">traffic_split</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">models</span> <span class="o">=</span> <span class="n">models</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">traffic_split</span> <span class="o">=</span> <span class="n">traffic_split</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span><span class="n">model_name</span><span class="p">:</span> <span class="p">[]</span> <span class="k">for</span> <span class="n">model_name</span> <span class="ow">in</span> <span class="n">models</span><span class="p">.</span><span class="n">keys</span><span class="p">()}</span>
    
    <span class="k">def</span> <span class="nf">get_model_for_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="bp">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="s">"""Determine which model to use for this request."""</span>
        <span class="k">if</span> <span class="n">user_id</span><span class="p">:</span>
            <span class="c1"># Consistent assignment based on user ID
</span>            <span class="n">random</span><span class="p">.</span><span class="n">seed</span><span class="p">(</span><span class="nb">hash</span><span class="p">(</span><span class="n">user_id</span><span class="p">))</span>
        
        <span class="n">rand_val</span> <span class="o">=</span> <span class="n">random</span><span class="p">.</span><span class="n">random</span><span class="p">()</span>
        <span class="n">cumulative_prob</span> <span class="o">=</span> <span class="mi">0</span>
        
        <span class="k">for</span> <span class="n">model_name</span><span class="p">,</span> <span class="n">prob</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">traffic_split</span><span class="p">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">cumulative_prob</span> <span class="o">+=</span> <span class="n">prob</span>
            <span class="k">if</span> <span class="n">rand_val</span> <span class="o">&lt;=</span> <span class="n">cumulative_prob</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">model_name</span>
        
        <span class="c1"># Fallback to first model
</span>        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">models</span><span class="p">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
    
    <span class="k">def</span> <span class="nf">make_prediction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">features</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
        <span class="n">model_name</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">get_model_for_request</span><span class="p">(</span><span class="n">user_id</span><span class="p">)</span>
        <span class="n">model</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">models</span><span class="p">[</span><span class="n">model_name</span><span class="p">]</span>
        
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">prediction</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">predict</span><span class="p">([</span><span class="nb">list</span><span class="p">(</span><span class="n">features</span><span class="p">.</span><span class="n">values</span><span class="p">())])[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">prediction_time</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
        
        <span class="c1"># Log for analysis
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">results</span><span class="p">[</span><span class="n">model_name</span><span class="p">].</span><span class="n">append</span><span class="p">({</span>
            <span class="s">'prediction'</span><span class="p">:</span> <span class="n">prediction</span><span class="p">,</span>
            <span class="s">'features'</span><span class="p">:</span> <span class="n">features</span><span class="p">,</span>
            <span class="s">'prediction_time'</span><span class="p">:</span> <span class="n">prediction_time</span><span class="p">,</span>
            <span class="s">'timestamp'</span><span class="p">:</span> <span class="n">datetime</span><span class="p">.</span><span class="n">now</span><span class="p">()</span>
        <span class="p">})</span>
        
        <span class="k">return</span> <span class="p">{</span>
            <span class="s">'prediction'</span><span class="p">:</span> <span class="n">prediction</span><span class="p">,</span>
            <span class="s">'model_used'</span><span class="p">:</span> <span class="n">model_name</span><span class="p">,</span>
            <span class="s">'prediction_time'</span><span class="p">:</span> <span class="n">prediction_time</span>
        <span class="p">}</span>
    
    <span class="k">def</span> <span class="nf">analyze_results</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">"""Analyze A/B test results."""</span>
        <span class="n">analysis</span> <span class="o">=</span> <span class="p">{}</span>
        
        <span class="k">for</span> <span class="n">model_name</span><span class="p">,</span> <span class="n">results</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">results</span><span class="p">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">results</span><span class="p">:</span>
                <span class="n">predictions</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span><span class="p">[</span><span class="s">'prediction'</span><span class="p">]</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">results</span><span class="p">]</span>
                <span class="n">times</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span><span class="p">[</span><span class="s">'prediction_time'</span><span class="p">]</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">results</span><span class="p">]</span>
                
                <span class="n">analysis</span><span class="p">[</span><span class="n">model_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s">'count'</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">),</span>
                    <span class="s">'avg_prediction'</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">predictions</span><span class="p">),</span>
                    <span class="s">'avg_latency'</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span><span class="n">times</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">times</span><span class="p">),</span>
                    <span class="s">'p95_latency'</span><span class="p">:</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">times</span><span class="p">)[</span><span class="nb">int</span><span class="p">(</span><span class="mf">0.95</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">times</span><span class="p">))]</span>
                <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">analysis</span>

<span class="c1"># Usage in FastAPI
</span><span class="n">ab_tester</span> <span class="o">=</span> <span class="n">ModelABTester</span><span class="p">(</span>
    <span class="n">models</span><span class="o">=</span><span class="p">{</span><span class="s">'model_v1'</span><span class="p">:</span> <span class="n">model_v1</span><span class="p">,</span> <span class="s">'model_v2'</span><span class="p">:</span> <span class="n">model_v2</span><span class="p">},</span>
    <span class="n">traffic_split</span><span class="o">=</span><span class="p">{</span><span class="s">'model_v1'</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">,</span> <span class="s">'model_v2'</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">}</span>
<span class="p">)</span>

<span class="o">@</span><span class="n">app</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="s">"/predict_ab"</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">predict_with_ab_test</span><span class="p">(</span><span class="n">request</span><span class="p">:</span> <span class="n">PredictionRequest</span><span class="p">,</span> <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">ab_tester</span><span class="p">.</span><span class="n">make_prediction</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="n">features</span><span class="p">,</span> <span class="n">user_id</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">result</span>
</code></pre></div></div>

<h2 id="model-rollback-strategy">Model Rollback Strategy</h2>

<h3 id="blue-green-deployment">Blue-Green Deployment</h3>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">ModelDeploymentManager</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">active_model</span> <span class="o">=</span> <span class="s">"blue"</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">models</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">"blue"</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
            <span class="s">"green"</span><span class="p">:</span> <span class="bp">None</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">health_checks</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">"blue"</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
            <span class="s">"green"</span><span class="p">:</span> <span class="bp">True</span>
        <span class="p">}</span>
    
    <span class="k">def</span> <span class="nf">deploy_new_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_model</span><span class="p">,</span> <span class="n">validation_data</span><span class="p">):</span>
        <span class="c1"># Deploy to inactive environment
</span>        <span class="n">inactive_env</span> <span class="o">=</span> <span class="s">"green"</span> <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">active_model</span> <span class="o">==</span> <span class="s">"blue"</span> <span class="k">else</span> <span class="s">"blue"</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">models</span><span class="p">[</span><span class="n">inactive_env</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_model</span>
        
        <span class="c1"># Run validation tests
</span>        <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">validate_model</span><span class="p">(</span><span class="n">new_model</span><span class="p">,</span> <span class="n">validation_data</span><span class="p">):</span>
            <span class="c1"># Switch traffic to new model
</span>            <span class="bp">self</span><span class="p">.</span><span class="n">active_model</span> <span class="o">=</span> <span class="n">inactive_env</span>
            <span class="n">logger</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s">"Successfully switched to </span><span class="si">{</span><span class="n">inactive_env</span><span class="si">}</span><span class="s"> environment"</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Rollback - keep current model active
</span>            <span class="n">logger</span><span class="p">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s">"Validation failed for </span><span class="si">{</span><span class="n">inactive_env</span><span class="si">}</span><span class="s">, keeping </span><span class="si">{</span><span class="bp">self</span><span class="p">.</span><span class="n">active_model</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">False</span>
    
    <span class="k">def</span> <span class="nf">validate_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">validation_data</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Run validation tests
</span>            <span class="n">predictions</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">validation_data</span><span class="p">[</span><span class="s">'features'</span><span class="p">])</span>
            <span class="n">accuracy</span> <span class="o">=</span> <span class="n">calculate_accuracy</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">validation_data</span><span class="p">[</span><span class="s">'targets'</span><span class="p">])</span>
            
            <span class="c1"># Check if accuracy meets threshold
</span>            <span class="k">return</span> <span class="n">accuracy</span> <span class="o">&gt;</span> <span class="mf">0.85</span>
        <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="p">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s">"Model validation failed: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">False</span>
    
    <span class="k">def</span> <span class="nf">get_active_model</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">models</span><span class="p">[</span><span class="bp">self</span><span class="p">.</span><span class="n">active_model</span><span class="p">]</span>
    
    <span class="k">def</span> <span class="nf">rollback</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Switch back to previous environment
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">active_model</span> <span class="o">=</span> <span class="s">"green"</span> <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">active_model</span> <span class="o">==</span> <span class="s">"blue"</span> <span class="k">else</span> <span class="s">"blue"</span>
        <span class="n">logger</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s">"Rolled back to </span><span class="si">{</span><span class="bp">self</span><span class="p">.</span><span class="n">active_model</span><span class="si">}</span><span class="s"> environment"</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="best-practices">Best Practices</h2>

<h3 id="1-model-versioning">1. Model Versioning</h3>
<ul>
  <li>Use semantic versioning for models</li>
  <li>Track model lineage and dependencies</li>
  <li>Maintain model metadata and documentation</li>
</ul>

<h3 id="2-automated-testing">2. Automated Testing</h3>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Model validation tests
</span><span class="k">def</span> <span class="nf">test_model_performance</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">test_data</span><span class="p">):</span>
    <span class="n">predictions</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_data</span><span class="p">[</span><span class="s">'features'</span><span class="p">])</span>
    <span class="n">accuracy</span> <span class="o">=</span> <span class="n">calculate_accuracy</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">test_data</span><span class="p">[</span><span class="s">'targets'</span><span class="p">])</span>
    <span class="k">assert</span> <span class="n">accuracy</span> <span class="o">&gt;</span> <span class="mf">0.8</span><span class="p">,</span> <span class="sa">f</span><span class="s">"Model accuracy </span><span class="si">{</span><span class="n">accuracy</span><span class="si">}</span><span class="s"> below threshold"</span>

<span class="k">def</span> <span class="nf">test_model_latency</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">sample_data</span><span class="p">):</span>
    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">model</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">sample_data</span><span class="p">)</span>
    <span class="n">latency</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
    <span class="k">assert</span> <span class="n">latency</span> <span class="o">&lt;</span> <span class="mf">0.1</span><span class="p">,</span> <span class="sa">f</span><span class="s">"Model latency </span><span class="si">{</span><span class="n">latency</span><span class="si">}</span><span class="s">s exceeds threshold"</span>

<span class="k">def</span> <span class="nf">test_model_memory_usage</span><span class="p">(</span><span class="n">model</span><span class="p">):</span>
    <span class="kn">import</span> <span class="nn">psutil</span>
    <span class="n">process</span> <span class="o">=</span> <span class="n">psutil</span><span class="p">.</span><span class="n">Process</span><span class="p">()</span>
    <span class="n">memory_before</span> <span class="o">=</span> <span class="n">process</span><span class="p">.</span><span class="n">memory_info</span><span class="p">().</span><span class="n">rss</span>
    
    <span class="c1"># Make predictions
</span>    <span class="n">model</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">sample_data</span><span class="p">)</span>
    
    <span class="n">memory_after</span> <span class="o">=</span> <span class="n">process</span><span class="p">.</span><span class="n">memory_info</span><span class="p">().</span><span class="n">rss</span>
    <span class="n">memory_increase</span> <span class="o">=</span> <span class="p">(</span><span class="n">memory_after</span> <span class="o">-</span> <span class="n">memory_before</span><span class="p">)</span> <span class="o">/</span> <span class="mi">1024</span> <span class="o">/</span> <span class="mi">1024</span>  <span class="c1"># MB
</span>    
    <span class="k">assert</span> <span class="n">memory_increase</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="p">,</span> <span class="sa">f</span><span class="s">"Memory increase </span><span class="si">{</span><span class="n">memory_increase</span><span class="si">}</span><span class="s">MB too high"</span>
</code></pre></div></div>

<h3 id="3-monitoring-and-alerting">3. Monitoring and Alerting</h3>
<ul>
  <li>Set up alerts for model performance degradation</li>
  <li>Monitor data drift and feature importance changes</li>
  <li>Track business metrics alongside technical metrics</li>
</ul>

<h3 id="4-security-considerations">4. Security Considerations</h3>
<ul>
  <li>Implement authentication and authorization</li>
  <li>Encrypt model artifacts and communications</li>
  <li>Regular security audits and vulnerability assessments</li>
</ul>

<h2 id="next-steps">Next Steps</h2>

<p>In upcoming posts, I’ll explore:</p>
<ul>
  <li>Advanced model monitoring techniques</li>
  <li>Feature stores and feature engineering pipelines</li>
  <li>Multi-model serving and ensemble strategies</li>
  <li>MLOps for deep learning and large language models</li>
</ul>

<p>MLOps is essential for scaling machine learning in production environments. By implementing proper deployment strategies, monitoring, and governance, organizations can reliably deliver ML-powered applications.</p>

<hr />

<p><em>Implementing MLOps in your organization? Share your challenges and successes!</em></p>

  </div>

  <!-- Social Share Buttons -->
  <div class="share-buttons">
    <h4>Share this post:</h4>
    <a href="https://twitter.com/intent/tweet?text=MLOps:%20Machine%20Learning%20Deployment%20Strategies&url=http://localhost:4009/2023/04/20/mlops-deployment-strategies/" 
       class="share-button" target="_blank" rel="noopener" aria-label="Share on Twitter">
      🐦 Twitter
    </a>
    <a href="https://www.linkedin.com/sharing/share-offsite/?url=http://localhost:4009/2023/04/20/mlops-deployment-strategies/" 
       class="share-button" target="_blank" rel="noopener" aria-label="Share on LinkedIn">
      💼 LinkedIn
    </a>
    <a href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4009/2023/04/20/mlops-deployment-strategies/" 
       class="share-button" target="_blank" rel="noopener" aria-label="Share on Facebook">
      📘 Facebook
    </a>
    <button class="share-button" onclick="copyToClipboard('http://localhost:4009/2023/04/20/mlops-deployment-strategies/')" aria-label="Copy link">
      🔗 Copy Link
    </button>
  </div>

  <!-- AI-Powered Recommendations -->
  <div class="recommendations">
    <h3>Recommended for you</h3>
    <div class="recommended-posts">
      
      
      
      
        <div class="post-card">
          <div class="post-image">💡</div>
          <h4><a href="/2025/08/20/ai-model-selection-strategies/">AI Model Selection: When to Use GPT vs Claude vs Open Source Models</a></h4>
          <div class="post-meta">August 20, 2025</div>
          <div class="post-excerpt">After using different AI models for 8 months, I've learned when each one shines. Here's my practical guide to choosing...</div>
        </div>
      
        <div class="post-card">
          <div class="post-image">💡</div>
          <h4><a href="/2025/06/15/voice-ai-integration-streamlit/">Voice AI Integration: Adding Speech to My AI Applications with Streamlit</a></h4>
          <div class="post-meta">June 15, 2025</div>
          <div class="post-excerpt">I added voice capabilities to my AI applications. Here's how I integrated speech-to-text and text-to-speech with Streamlit for hands-free AI...</div>
        </div>
      
        <div class="post-card">
          <div class="post-image">💡</div>
          <h4><a href="/2025/04/10/building-multi-agent-systems-crewai/">Building Multi-Agent Systems with CrewAI: Beyond Single AI Assistants</a></h4>
          <div class="post-meta">April 10, 2025</div>
          <div class="post-excerpt">I built my first multi-agent system using CrewAI. Here's what I learned about orchestrating multiple AI agents to solve complex...</div>
        </div>
      
        <div class="post-card">
          <div class="post-image">💡</div>
          <h4><a href="/2025/02/20/chain-of-thought-prompting-business-logic/">Chain-of-Thought Prompting: Improving AI Reasoning in Business Applications</a></h4>
          <div class="post-meta">February 20, 2025</div>
          <div class="post-excerpt">Can we get LLMs to reason through complex business rules reliably? My experiments with chain-of-thought prompting for healthcare protocols.</div>
        </div>
      
        <div class="post-card">
          <div class="post-image">💡</div>
          <h4><a href="/2025/01/15/advanced-prompt-engineering-techniques/">Advanced Prompt Engineering: Techniques I've Learned from 6 Months with LLMs</a></h4>
          <div class="post-meta">January 15, 2025</div>
          <div class="post-excerpt">After 6 months of working with LLMs daily, I've discovered prompt engineering is both an art and a science. Here...</div>
        </div>
      
        <div class="post-card">
          <div class="post-image">💡</div>
          <h4><a href="/2024/12/15/agentic-ai-customer-service-automation/">Building an Agentic AI Customer Service System: A Complete Case Study</a></h4>
          <div class="post-meta">December 15, 2024</div>
          <div class="post-excerpt">How I built a multi-agent customer service system that reduced response time by 85% and improved satisfaction scores by 40%...</div>
        </div>
      
        <div class="post-card">
          <div class="post-image">💡</div>
          <h4><a href="/2024/10/20/getting-started-langchain-rag/">Building RAG Systems: My Journey with LangChain</a></h4>
          <div class="post-meta">October 20, 2024</div>
          <div class="post-excerpt">After months of hearing about RAG and LangChain, I finally built my first retrieval-augmented generation system. Here's what I learned....</div>
        </div>
      
        <div class="post-card">
          <div class="post-image">💡</div>
          <h4><a href="/2024/09/10/ai-powered-data-quality-monitoring/">AI-Powered Data Quality Monitoring: The Future of Data Reliability</a></h4>
          <div class="post-meta">September 10, 2024</div>
          <div class="post-excerpt">Discover how artificial intelligence is revolutionizing data quality monitoring with automated anomaly detection, intelligent alerting, and predictive data health insights....</div>
        </div>
      
        <div class="post-card">
          <div class="post-image">💡</div>
          <h4><a href="/2024/06/20/advanced-kafka-streaming-patterns/">Advanced Kafka Streaming Patterns for Real-Time Analytics</a></h4>
          <div class="post-meta">June 20, 2024</div>
          <div class="post-excerpt">Explore advanced Apache Kafka streaming patterns including exactly-once processing, windowing operations, and complex event processing for building robust real-time analytics...</div>
        </div>
      
        <div class="post-card">
          <div class="post-image">💡</div>
          <h4><a href="/2024/03/15/building-enterprise-ai-customer-support-system/">Building an Enterprise AI Customer Support System: From Concept to $485K Annual Savings</a></h4>
          <div class="post-meta">March 15, 2024</div>
          <div class="post-excerpt">How I built a Fortune 500-grade multi-agent customer support system using 100% free technologies, achieving 85% faster response times and...</div>
        </div>
      
    </div>
  </div>

  <!-- Comments Section -->
  
</article>

<script>
  function copyToClipboard(text) {
    navigator.clipboard.writeText(text).then(() => {
      alert('Link copied to clipboard!');
    });
  }
</script>
    </main>
    
    <!-- WhatsApp Chat Widget -->
    <div class="whatsapp-chat" id="whatsapp-chat">
        <div class="chat-bubble">
            <svg viewBox="0 0 24 24" fill="white">
                <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0020.885 3.488"/>
            </svg>
        </div>
        <div class="chat-tooltip">Chat with me on WhatsApp!</div>
    </div>

    <footer role="contentinfo">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h4>Connect</h4>
                    <div class="social-links">
                        <a href="https://github.com/niranjanagaram" aria-label="GitHub Profile">GitHub</a>
                        <a href="https://linkedin.com/in/niranjan-agaram" aria-label="LinkedIn Profile">LinkedIn</a>
                        <a href="mailto:niranjan@example.com" aria-label="Email Contact">Email</a>
                    </div>
                </div>
                <div class="footer-section">
                    <h4>Subscribe</h4>
                    <a href="/feed.xml" aria-label="RSS Feed">RSS Feed</a>
                </div>
            </div>
            <p>&copy; 2025 Niranjan's AI Insights. All rights reserved.</p>
        </div>
    </footer>
    
    <!-- Service Worker -->
    <script>
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('/sw.js');
        }
        
        // Modern Theme Toggle
        const themeToggle = document.getElementById('theme-toggle');
        const currentTheme = localStorage.getItem('theme') || 'dark';
        
        document.documentElement.setAttribute('data-theme', currentTheme);
        
        themeToggle.addEventListener('click', () => {
            const theme = document.documentElement.getAttribute('data-theme');
            const newTheme = theme === 'dark' ? 'light' : 'dark';
            document.documentElement.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
        });
        
        // Reading Progress
        window.addEventListener('scroll', () => {
            const progress = document.getElementById('reading-progress');
            const scrolled = (window.scrollY / (document.body.scrollHeight - window.innerHeight)) * 100;
            progress.style.width = scrolled + '%';
        });
        

    </script>
</body>
</html>