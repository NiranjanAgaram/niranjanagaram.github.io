<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Real-time Data Processing with Apache Kafka">
    <meta name="author" content="Niranjan Agaram">
    <meta name="robots" content="index, follow">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="post">
    <meta property="og:url" content="http://0.0.0.0:4001/2024/03/15/real-time-data-processing-kafka/">
    <meta property="og:title" content="Real-time Data Processing with Apache Kafka">
    <meta property="og:description" content="Real-time Data Processing with Apache Kafka">
    <meta property="og:image" content="http://0.0.0.0:4001/assets/images/og-image.svg">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="http://0.0.0.0:4001/2024/03/15/real-time-data-processing-kafka/">
    <meta property="twitter:title" content="Real-time Data Processing with Apache Kafka">
    <meta property="twitter:description" content="Real-time Data Processing with Apache Kafka">
    <meta property="twitter:image" content="http://0.0.0.0:4001/assets/images/og-image.svg">
    
    <!-- Enhanced Structured Data -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "name": "Niranjan Agaram",
      "jobTitle": "AI & Data Engineering Consultant",
      "description": "10+ years evolving from data engineering to agentic AI systems across healthcare, retail, marketing, and real estate",
      "url": "http://0.0.0.0:4001",
      "sameAs": [
        "https://linkedin.com/in/niranjan-agaram",
        "https://github.com/niranjanagaram"
      ],
      "knowsAbout": [
        "Artificial Intelligence",
        "Data Engineering", 
        "Machine Learning",
        "LangChain",
        "CrewAI",
        "FastAPI",
        "Python",
        "SAS",
        "Multi-Agent Systems"
      ],
      "hasOccupation": {
        "@type": "Occupation",
        "name": "AI Consultant",
        "occupationLocation": {
          "@type": "Country",
          "name": "India"
        }
      }
    }
    </script>
    
    <title>Real-time Data Processing with Apache Kafka</title>
    <link rel="canonical" href="http://0.0.0.0:4001/2024/03/15/real-time-data-processing-kafka/">
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="stylesheet" href="/assets/css/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#3b82f6">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Niranjan AI">
    <script src="/assets/js/main.js" defer></script>
    <script src="/assets/js/search.js" defer></script>
    <script src="/assets/js/performance.js" defer></script>
    
    <!-- Analytics -->
    
</head>
<body>
    <a href="#main-content" class="skip-link" aria-label="Skip to main content">Skip to main content</a>
    <div class="bg-orb orb-1" aria-hidden="true"></div>
    <div class="bg-orb orb-2" aria-hidden="true"></div>
    
    <!-- Progress Bar -->
    <div class="reading-progress" id="reading-progress" aria-hidden="true"></div>
    
    <header role="banner">
        <div class="container">
            <h1><a href="/" aria-label="Home - Niranjan's AI Insights">Niranjan's AI Insights</a></h1>
            <p>Enterprise AI solutions, agentic systems, and intelligent automation insights from a senior data engineer</p>
            
            <!-- Search -->
            <div class="search-container">
                <input type="search" id="search-input" placeholder="Search posts..." aria-label="Search blog posts">
                <div id="search-results" class="search-results" aria-live="polite"></div>
            </div>
            
            <nav role="navigation" aria-label="Main navigation">
                <div class="nav-links">
                    <a href="/" >Home</a>
                    <a href="/posts" >Posts</a>
                    <a href="/services" >Services</a>
                    <a href="/about" >About</a>
                    <a href="/contact" >Contact</a>
                    <a href="/archive" >Archive</a>
                </div>
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle dark/light mode"></button>
            </nav>
        </div>
    </header>
    
    <main id="main-content" class="container" role="main">
        <article itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    <h1 itemprop="headline">Real-time Data Processing with Apache Kafka</h1>
    <div class="post-meta">
      <time datetime="2024-03-15T00:00:00+05:30" itemprop="datePublished">
        March 15, 2024
      </time>
      
      <span class="reading-time">üìñ 11 min read</span>
    </div>
    
    <div class="tags">
      
        <span class="tag" itemprop="keywords">apache-kafka</span>
      
        <span class="tag" itemprop="keywords">real-time-processing</span>
      
        <span class="tag" itemprop="keywords">streaming</span>
      
        <span class="tag" itemprop="keywords">event-driven-architecture</span>
      
    </div>
    
  </header>

  <div itemprop="articleBody">
    <h1 id="real-time-data-processing-with-apache-kafka">Real-time Data Processing with Apache Kafka</h1>

<p>In today‚Äôs fast-paced digital world, the ability to process data in real-time is crucial. Apache Kafka has emerged as the de facto standard for building real-time streaming data pipelines.</p>

<h2 id="why-apache-kafka">Why Apache Kafka?</h2>

<p>Kafka provides:</p>
<ul>
  <li><strong>High throughput</strong>: Handle millions of messages per second</li>
  <li><strong>Low latency</strong>: Sub-millisecond message delivery</li>
  <li><strong>Fault tolerance</strong>: Distributed architecture with replication</li>
  <li><strong>Scalability</strong>: Horizontal scaling across multiple brokers</li>
  <li><strong>Durability</strong>: Persistent storage with configurable retention</li>
</ul>

<h2 id="kafka-architecture-overview">Kafka Architecture Overview</h2>

<h3 id="core-components">Core Components</h3>
<ul>
  <li><strong>Producers</strong>: Applications that send data to Kafka topics</li>
  <li><strong>Consumers</strong>: Applications that read data from Kafka topics</li>
  <li><strong>Brokers</strong>: Kafka servers that store and serve data</li>
  <li><strong>Topics</strong>: Categories or feeds of messages</li>
  <li><strong>Partitions</strong>: Scalable units within topics</li>
</ul>

<h2 id="setting-up-kafka">Setting Up Kafka</h2>

<h3 id="docker-compose-setup">Docker Compose Setup</h3>
<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">version</span><span class="pi">:</span> <span class="s1">'</span><span class="s">3.8'</span>
<span class="na">services</span><span class="pi">:</span>
  <span class="na">zookeeper</span><span class="pi">:</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">confluentinc/cp-zookeeper:7.4.0</span>
    <span class="na">environment</span><span class="pi">:</span>
      <span class="na">ZOOKEEPER_CLIENT_PORT</span><span class="pi">:</span> <span class="m">2181</span>
      <span class="na">ZOOKEEPER_TICK_TIME</span><span class="pi">:</span> <span class="m">2000</span>

  <span class="na">kafka</span><span class="pi">:</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">confluentinc/cp-kafka:7.4.0</span>
    <span class="na">depends_on</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">zookeeper</span>
    <span class="na">ports</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s2">"</span><span class="s">9092:9092"</span>
    <span class="na">environment</span><span class="pi">:</span>
      <span class="na">KAFKA_BROKER_ID</span><span class="pi">:</span> <span class="m">1</span>
      <span class="na">KAFKA_ZOOKEEPER_CONNECT</span><span class="pi">:</span> <span class="s">zookeeper:2181</span>
      <span class="na">KAFKA_ADVERTISED_LISTENERS</span><span class="pi">:</span> <span class="s">PLAINTEXT://localhost:9092</span>
      <span class="na">KAFKA_OFFSETS_TOPIC_REPLICATION_FACTOR</span><span class="pi">:</span> <span class="m">1</span>
</code></pre></div></div>

<h3 id="creating-topics">Creating Topics</h3>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Create a topic for user events</span>
kafka-topics <span class="nt">--create</span> <span class="se">\</span>
  <span class="nt">--bootstrap-server</span> localhost:9092 <span class="se">\</span>
  <span class="nt">--topic</span> user-events <span class="se">\</span>
  <span class="nt">--partitions</span> 3 <span class="se">\</span>
  <span class="nt">--replication-factor</span> 1
</code></pre></div></div>

<h2 id="building-kafka-producers">Building Kafka Producers</h2>

<h3 id="python-producer-example">Python Producer Example</h3>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">kafka</span> <span class="kn">import</span> <span class="n">KafkaProducer</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>

<span class="k">class</span> <span class="nc">UserEventProducer</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bootstrap_servers</span><span class="o">=</span><span class="p">[</span><span class="s">'localhost:9092'</span><span class="p">]):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">producer</span> <span class="o">=</span> <span class="n">KafkaProducer</span><span class="p">(</span>
            <span class="n">bootstrap_servers</span><span class="o">=</span><span class="n">bootstrap_servers</span><span class="p">,</span>
            <span class="n">value_serializer</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">x</span><span class="p">).</span><span class="n">encode</span><span class="p">(</span><span class="s">'utf-8'</span><span class="p">),</span>
            <span class="n">key_serializer</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">'utf-8'</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span> <span class="k">else</span> <span class="bp">None</span><span class="p">,</span>
            <span class="n">acks</span><span class="o">=</span><span class="s">'all'</span><span class="p">,</span>  <span class="c1"># Wait for all replicas to acknowledge
</span>            <span class="n">retries</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
            <span class="n">batch_size</span><span class="o">=</span><span class="mi">16384</span><span class="p">,</span>
            <span class="n">linger_ms</span><span class="o">=</span><span class="mi">10</span>
        <span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">send_user_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">,</span> <span class="n">event_type</span><span class="p">,</span> <span class="n">event_data</span><span class="p">):</span>
        <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">'user_id'</span><span class="p">:</span> <span class="n">user_id</span><span class="p">,</span>
            <span class="s">'event_type'</span><span class="p">:</span> <span class="n">event_type</span><span class="p">,</span>
            <span class="s">'event_data'</span><span class="p">:</span> <span class="n">event_data</span><span class="p">,</span>
            <span class="s">'timestamp'</span><span class="p">:</span> <span class="n">datetime</span><span class="p">.</span><span class="n">utcnow</span><span class="p">().</span><span class="n">isoformat</span><span class="p">()</span>
        <span class="p">}</span>
        
        <span class="c1"># Use user_id as partition key for ordering
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">producer</span><span class="p">.</span><span class="n">send</span><span class="p">(</span>
            <span class="s">'user-events'</span><span class="p">,</span>
            <span class="n">key</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">user_id</span><span class="p">),</span>
            <span class="n">value</span><span class="o">=</span><span class="n">event</span>
        <span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">producer</span><span class="p">.</span><span class="n">flush</span><span class="p">()</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">producer</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>

<span class="c1"># Usage example
</span><span class="n">producer</span> <span class="o">=</span> <span class="n">UserEventProducer</span><span class="p">()</span>
<span class="n">producer</span><span class="p">.</span><span class="n">send_user_event</span><span class="p">(</span>
    <span class="n">user_id</span><span class="o">=</span><span class="mi">12345</span><span class="p">,</span>
    <span class="n">event_type</span><span class="o">=</span><span class="s">'page_view'</span><span class="p">,</span>
    <span class="n">event_data</span><span class="o">=</span><span class="p">{</span><span class="s">'page'</span><span class="p">:</span> <span class="s">'/products'</span><span class="p">,</span> <span class="s">'duration'</span><span class="p">:</span> <span class="mi">45</span><span class="p">}</span>
<span class="p">)</span>
</code></pre></div></div>

<h3 id="java-producer-example">Java Producer Example</h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">org.apache.kafka.clients.producer.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.kafka.common.serialization.StringSerializer</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Properties</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserEventProducer</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">Producer</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="n">producer</span><span class="o">;</span>
    
    <span class="kd">public</span> <span class="nf">UserEventProducer</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">Properties</span> <span class="n">props</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Properties</span><span class="o">();</span>
        <span class="n">props</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="nc">ProducerConfig</span><span class="o">.</span><span class="na">BOOTSTRAP_SERVERS_CONFIG</span><span class="o">,</span> <span class="s">"localhost:9092"</span><span class="o">);</span>
        <span class="n">props</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="nc">ProducerConfig</span><span class="o">.</span><span class="na">KEY_SERIALIZER_CLASS_CONFIG</span><span class="o">,</span> <span class="nc">StringSerializer</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
        <span class="n">props</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="nc">ProducerConfig</span><span class="o">.</span><span class="na">VALUE_SERIALIZER_CLASS_CONFIG</span><span class="o">,</span> <span class="nc">StringSerializer</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
        <span class="n">props</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="nc">ProducerConfig</span><span class="o">.</span><span class="na">ACKS_CONFIG</span><span class="o">,</span> <span class="s">"all"</span><span class="o">);</span>
        <span class="n">props</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="nc">ProducerConfig</span><span class="o">.</span><span class="na">RETRIES_CONFIG</span><span class="o">,</span> <span class="mi">3</span><span class="o">);</span>
        <span class="n">props</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="nc">ProducerConfig</span><span class="o">.</span><span class="na">BATCH_SIZE_CONFIG</span><span class="o">,</span> <span class="mi">16384</span><span class="o">);</span>
        <span class="n">props</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="nc">ProducerConfig</span><span class="o">.</span><span class="na">LINGER_MS_CONFIG</span><span class="o">,</span> <span class="mi">10</span><span class="o">);</span>
        
        <span class="k">this</span><span class="o">.</span><span class="na">producer</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">KafkaProducer</span><span class="o">&lt;&gt;(</span><span class="n">props</span><span class="o">);</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">sendEvent</span><span class="o">(</span><span class="nc">String</span> <span class="n">userId</span><span class="o">,</span> <span class="nc">String</span> <span class="n">eventJson</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">ProducerRecord</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="n">record</span> <span class="o">=</span> 
            <span class="k">new</span> <span class="nc">ProducerRecord</span><span class="o">&lt;&gt;(</span><span class="s">"user-events"</span><span class="o">,</span> <span class="n">userId</span><span class="o">,</span> <span class="n">eventJson</span><span class="o">);</span>
        
        <span class="n">producer</span><span class="o">.</span><span class="na">send</span><span class="o">(</span><span class="n">record</span><span class="o">,</span> <span class="o">(</span><span class="n">metadata</span><span class="o">,</span> <span class="n">exception</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="o">{</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">exception</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">exception</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
            <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span><span class="s">"Sent event to partition %d with offset %d%n"</span><span class="o">,</span>
                    <span class="n">metadata</span><span class="o">.</span><span class="na">partition</span><span class="o">(),</span> <span class="n">metadata</span><span class="o">.</span><span class="na">offset</span><span class="o">());</span>
            <span class="o">}</span>
        <span class="o">});</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h2 id="building-kafka-consumers">Building Kafka Consumers</h2>

<h3 id="python-consumer-example">Python Consumer Example</h3>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">kafka</span> <span class="kn">import</span> <span class="n">KafkaConsumer</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="k">class</span> <span class="nc">UserEventConsumer</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">group_id</span><span class="p">,</span> <span class="n">bootstrap_servers</span><span class="o">=</span><span class="p">[</span><span class="s">'localhost:9092'</span><span class="p">]):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">consumer</span> <span class="o">=</span> <span class="n">KafkaConsumer</span><span class="p">(</span>
            <span class="s">'user-events'</span><span class="p">,</span>
            <span class="n">bootstrap_servers</span><span class="o">=</span><span class="n">bootstrap_servers</span><span class="p">,</span>
            <span class="n">group_id</span><span class="o">=</span><span class="n">group_id</span><span class="p">,</span>
            <span class="n">value_deserializer</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">json</span><span class="p">.</span><span class="n">loads</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="n">decode</span><span class="p">(</span><span class="s">'utf-8'</span><span class="p">)),</span>
            <span class="n">key_deserializer</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">.</span><span class="n">decode</span><span class="p">(</span><span class="s">'utf-8'</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span> <span class="k">else</span> <span class="bp">None</span><span class="p">,</span>
            <span class="n">auto_offset_reset</span><span class="o">=</span><span class="s">'earliest'</span><span class="p">,</span>
            <span class="n">enable_auto_commit</span><span class="o">=</span><span class="bp">False</span>
        <span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">process_events</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">message</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">consumer</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">event</span> <span class="o">=</span> <span class="n">message</span><span class="p">.</span><span class="n">value</span>
                <span class="n">user_id</span> <span class="o">=</span> <span class="n">message</span><span class="p">.</span><span class="n">key</span>
                
                <span class="c1"># Process the event
</span>                <span class="bp">self</span><span class="p">.</span><span class="n">handle_event</span><span class="p">(</span><span class="n">user_id</span><span class="p">,</span> <span class="n">event</span><span class="p">)</span>
                
                <span class="c1"># Commit offset after successful processing
</span>                <span class="bp">self</span><span class="p">.</span><span class="n">consumer</span><span class="p">.</span><span class="n">commit</span><span class="p">()</span>
                
            <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Error processing event: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
                <span class="c1"># Handle error (retry, dead letter queue, etc.)
</span>    
    <span class="k">def</span> <span class="nf">handle_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="n">event_type</span> <span class="o">=</span> <span class="n">event</span><span class="p">[</span><span class="s">'event_type'</span><span class="p">]</span>
        
        <span class="k">if</span> <span class="n">event_type</span> <span class="o">==</span> <span class="s">'page_view'</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">update_user_analytics</span><span class="p">(</span><span class="n">user_id</span><span class="p">,</span> <span class="n">event</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">event_type</span> <span class="o">==</span> <span class="s">'purchase'</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">process_purchase</span><span class="p">(</span><span class="n">user_id</span><span class="p">,</span> <span class="n">event</span><span class="p">)</span>
        
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Processed </span><span class="si">{</span><span class="n">event_type</span><span class="si">}</span><span class="s"> for user </span><span class="si">{</span><span class="n">user_id</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">update_user_analytics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="c1"># Update real-time analytics
</span>        <span class="k">pass</span>
    
    <span class="k">def</span> <span class="nf">process_purchase</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="c1"># Process purchase event
</span>        <span class="k">pass</span>

<span class="c1"># Usage
</span><span class="n">consumer</span> <span class="o">=</span> <span class="n">UserEventConsumer</span><span class="p">(</span><span class="n">group_id</span><span class="o">=</span><span class="s">'analytics-service'</span><span class="p">)</span>
<span class="n">consumer</span><span class="p">.</span><span class="n">process_events</span><span class="p">()</span>
</code></pre></div></div>

<h2 id="stream-processing-with-kafka-streams">Stream Processing with Kafka Streams</h2>

<h3 id="real-time-aggregations">Real-time Aggregations</h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">org.apache.kafka.streams.KafkaStreams</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.kafka.streams.StreamsBuilder</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.kafka.streams.kstream.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.time.Duration</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserEventAnalytics</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">StreamsBuilder</span> <span class="n">builder</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">StreamsBuilder</span><span class="o">();</span>
        
        <span class="nc">KStream</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="n">events</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="na">stream</span><span class="o">(</span><span class="s">"user-events"</span><span class="o">);</span>
        
        <span class="c1">// Count events by type in 5-minute windows</span>
        <span class="nc">KTable</span><span class="o">&lt;</span><span class="nc">Windowed</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;,</span> <span class="nc">Long</span><span class="o">&gt;</span> <span class="n">eventCounts</span> <span class="o">=</span> <span class="n">events</span>
            <span class="o">.</span><span class="na">selectKey</span><span class="o">((</span><span class="n">key</span><span class="o">,</span> <span class="n">value</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="n">extractEventType</span><span class="o">(</span><span class="n">value</span><span class="o">))</span>
            <span class="o">.</span><span class="na">groupByKey</span><span class="o">()</span>
            <span class="o">.</span><span class="na">windowedBy</span><span class="o">(</span><span class="nc">TimeWindows</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="nc">Duration</span><span class="o">.</span><span class="na">ofMinutes</span><span class="o">(</span><span class="mi">5</span><span class="o">)))</span>
            <span class="o">.</span><span class="na">count</span><span class="o">();</span>
        
        <span class="c1">// Output to results topic</span>
        <span class="n">eventCounts</span><span class="o">.</span><span class="na">toStream</span><span class="o">()</span>
            <span class="o">.</span><span class="na">map</span><span class="o">((</span><span class="n">key</span><span class="o">,</span> <span class="n">value</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="nc">KeyValue</span><span class="o">.</span><span class="na">pair</span><span class="o">(</span>
                <span class="n">key</span><span class="o">.</span><span class="na">key</span><span class="o">()</span> <span class="o">+</span> <span class="s">"@"</span> <span class="o">+</span> <span class="n">key</span><span class="o">.</span><span class="na">window</span><span class="o">().</span><span class="na">start</span><span class="o">(),</span>
                <span class="n">value</span><span class="o">.</span><span class="na">toString</span><span class="o">()</span>
            <span class="o">))</span>
            <span class="o">.</span><span class="na">to</span><span class="o">(</span><span class="s">"event-counts"</span><span class="o">);</span>
        
        <span class="nc">KafkaStreams</span> <span class="n">streams</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">KafkaStreams</span><span class="o">(</span><span class="n">builder</span><span class="o">.</span><span class="na">build</span><span class="o">(),</span> <span class="n">getProperties</span><span class="o">());</span>
        <span class="n">streams</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
    <span class="o">}</span>
    
    <span class="kd">private</span> <span class="kd">static</span> <span class="nc">String</span> <span class="nf">extractEventType</span><span class="o">(</span><span class="nc">String</span> <span class="n">eventJson</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// Parse JSON and extract event_type</span>
        <span class="k">return</span> <span class="s">"page_view"</span><span class="o">;</span> <span class="c1">// Simplified</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h2 id="advanced-kafka-patterns">Advanced Kafka Patterns</h2>

<h3 id="exactly-once-processing">Exactly-Once Processing</h3>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">kafka</span> <span class="kn">import</span> <span class="n">KafkaConsumer</span><span class="p">,</span> <span class="n">KafkaProducer</span>
<span class="kn">import</span> <span class="nn">psycopg2</span>

<span class="k">class</span> <span class="nc">ExactlyOnceProcessor</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">consumer</span> <span class="o">=</span> <span class="n">KafkaConsumer</span><span class="p">(</span>
            <span class="s">'input-topic'</span><span class="p">,</span>
            <span class="n">group_id</span><span class="o">=</span><span class="s">'processor-group'</span><span class="p">,</span>
            <span class="n">enable_auto_commit</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
            <span class="n">isolation_level</span><span class="o">=</span><span class="s">'read_committed'</span>
        <span class="p">)</span>
        
        <span class="bp">self</span><span class="p">.</span><span class="n">producer</span> <span class="o">=</span> <span class="n">KafkaProducer</span><span class="p">(</span>
            <span class="n">transactional_id</span><span class="o">=</span><span class="s">'processor-tx'</span><span class="p">,</span>
            <span class="n">enable_idempotence</span><span class="o">=</span><span class="bp">True</span>
        <span class="p">)</span>
        
        <span class="bp">self</span><span class="p">.</span><span class="n">db_conn</span> <span class="o">=</span> <span class="n">psycopg2</span><span class="p">.</span><span class="n">connect</span><span class="p">(</span>
            <span class="n">host</span><span class="o">=</span><span class="s">'localhost'</span><span class="p">,</span>
            <span class="n">database</span><span class="o">=</span><span class="s">'analytics'</span><span class="p">,</span>
            <span class="n">user</span><span class="o">=</span><span class="s">'user'</span><span class="p">,</span>
            <span class="n">password</span><span class="o">=</span><span class="s">'password'</span>
        <span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">process_with_transactions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">producer</span><span class="p">.</span><span class="n">init_transactions</span><span class="p">()</span>
        
        <span class="k">for</span> <span class="n">message</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">consumer</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">producer</span><span class="p">.</span><span class="n">begin_transaction</span><span class="p">()</span>
                
                <span class="c1"># Process message
</span>                <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">process_message</span><span class="p">(</span><span class="n">message</span><span class="p">.</span><span class="n">value</span><span class="p">)</span>
                
                <span class="c1"># Send to output topic
</span>                <span class="bp">self</span><span class="p">.</span><span class="n">producer</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="s">'output-topic'</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
                
                <span class="c1"># Update database
</span>                <span class="k">with</span> <span class="bp">self</span><span class="p">.</span><span class="n">db_conn</span><span class="p">.</span><span class="n">cursor</span><span class="p">()</span> <span class="k">as</span> <span class="n">cursor</span><span class="p">:</span>
                    <span class="n">cursor</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span>
                        <span class="s">"INSERT INTO processed_events (id, data) VALUES (%s, %s)"</span><span class="p">,</span>
                        <span class="p">(</span><span class="n">message</span><span class="p">.</span><span class="n">offset</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
                    <span class="p">)</span>
                
                <span class="c1"># Commit transaction
</span>                <span class="bp">self</span><span class="p">.</span><span class="n">producer</span><span class="p">.</span><span class="n">commit_transaction</span><span class="p">()</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">db_conn</span><span class="p">.</span><span class="n">commit</span><span class="p">()</span>
                
                <span class="c1"># Commit Kafka offset
</span>                <span class="bp">self</span><span class="p">.</span><span class="n">consumer</span><span class="p">.</span><span class="n">commit</span><span class="p">()</span>
                
            <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">producer</span><span class="p">.</span><span class="n">abort_transaction</span><span class="p">()</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">db_conn</span><span class="p">.</span><span class="n">rollback</span><span class="p">()</span>
                <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Transaction aborted: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="monitoring-and-operations">Monitoring and Operations</h2>

<h3 id="key-metrics-to-monitor">Key Metrics to Monitor</h3>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Example monitoring with Prometheus
</span><span class="kn">from</span> <span class="nn">prometheus_client</span> <span class="kn">import</span> <span class="n">Counter</span><span class="p">,</span> <span class="n">Histogram</span><span class="p">,</span> <span class="n">Gauge</span>

<span class="c1"># Metrics
</span><span class="n">messages_produced</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="s">'kafka_messages_produced_total'</span><span class="p">,</span> <span class="s">'Total messages produced'</span><span class="p">)</span>
<span class="n">processing_time</span> <span class="o">=</span> <span class="n">Histogram</span><span class="p">(</span><span class="s">'kafka_message_processing_seconds'</span><span class="p">,</span> <span class="s">'Message processing time'</span><span class="p">)</span>
<span class="n">consumer_lag</span> <span class="o">=</span> <span class="n">Gauge</span><span class="p">(</span><span class="s">'kafka_consumer_lag'</span><span class="p">,</span> <span class="s">'Consumer lag by partition'</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">monitor_consumer_lag</span><span class="p">():</span>
    <span class="c1"># Get consumer group metadata
</span>    <span class="n">admin_client</span> <span class="o">=</span> <span class="n">KafkaAdminClient</span><span class="p">(</span><span class="n">bootstrap_servers</span><span class="o">=</span><span class="p">[</span><span class="s">'localhost:9092'</span><span class="p">])</span>
    
    <span class="c1"># Calculate and expose lag metrics
</span>    <span class="k">for</span> <span class="n">partition_metadata</span> <span class="ow">in</span> <span class="n">get_consumer_lag</span><span class="p">():</span>
        <span class="n">consumer_lag</span><span class="p">.</span><span class="n">labels</span><span class="p">(</span>
            <span class="n">topic</span><span class="o">=</span><span class="n">partition_metadata</span><span class="p">.</span><span class="n">topic</span><span class="p">,</span>
            <span class="n">partition</span><span class="o">=</span><span class="n">partition_metadata</span><span class="p">.</span><span class="n">partition</span>
        <span class="p">).</span><span class="nb">set</span><span class="p">(</span><span class="n">partition_metadata</span><span class="p">.</span><span class="n">lag</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="best-practices">Best Practices</h2>

<h3 id="1-topic-design">1. Topic Design</h3>
<ul>
  <li>Use meaningful topic names</li>
  <li>Plan partition strategy carefully</li>
  <li>Set appropriate retention policies</li>
</ul>

<h3 id="2-producer-optimization">2. Producer Optimization</h3>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Optimized producer configuration
</span><span class="n">producer_config</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">'bootstrap_servers'</span><span class="p">:</span> <span class="p">[</span><span class="s">'localhost:9092'</span><span class="p">],</span>
    <span class="s">'acks'</span><span class="p">:</span> <span class="s">'all'</span><span class="p">,</span>
    <span class="s">'retries'</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
    <span class="s">'batch_size'</span><span class="p">:</span> <span class="mi">16384</span><span class="p">,</span>
    <span class="s">'linger_ms'</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
    <span class="s">'compression_type'</span><span class="p">:</span> <span class="s">'snappy'</span><span class="p">,</span>
    <span class="s">'max_in_flight_requests_per_connection'</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
    <span class="s">'enable_idempotence'</span><span class="p">:</span> <span class="bp">True</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="3-consumer-best-practices">3. Consumer Best Practices</h3>
<ul>
  <li>Handle rebalancing gracefully</li>
  <li>Implement proper error handling</li>
  <li>Monitor consumer lag</li>
  <li>Use appropriate commit strategies</li>
</ul>

<h2 id="common-use-cases">Common Use Cases</h2>

<ol>
  <li><strong>Real-time Analytics</strong>: Process events for dashboards</li>
  <li><strong>Event Sourcing</strong>: Store all state changes as events</li>
  <li><strong>Microservices Communication</strong>: Decouple services with events</li>
  <li><strong>Log Aggregation</strong>: Centralize logs from multiple services</li>
  <li><strong>Change Data Capture</strong>: Stream database changes</li>
</ol>

<h2 id="next-steps">Next Steps</h2>

<p>In upcoming posts, I‚Äôll cover:</p>
<ul>
  <li>Kafka Connect for data integration</li>
  <li>Schema Registry and Avro serialization</li>
  <li>Kafka security and multi-tenancy</li>
  <li>Performance tuning and troubleshooting</li>
</ul>

<p>Apache Kafka enables building robust, scalable real-time data processing systems that form the backbone of modern data architectures.</p>

<hr />

<p><em>Working with Kafka in production? Share your experiences and challenges!</em></p>

  </div>

  <!-- Social Share Buttons -->
  <div class="share-buttons">
    <h4>Share this post:</h4>
    <a href="https://twitter.com/intent/tweet?text=Real-time%20Data%20Processing%20with%20Apache%20Kafka&url=http://0.0.0.0:4001/2024/03/15/real-time-data-processing-kafka/" 
       class="share-button" target="_blank" rel="noopener" aria-label="Share on Twitter">
      üê¶ Twitter
    </a>
    <a href="https://www.linkedin.com/sharing/share-offsite/?url=http://0.0.0.0:4001/2024/03/15/real-time-data-processing-kafka/" 
       class="share-button" target="_blank" rel="noopener" aria-label="Share on LinkedIn">
      üíº LinkedIn
    </a>
    <a href="https://www.facebook.com/sharer/sharer.php?u=http://0.0.0.0:4001/2024/03/15/real-time-data-processing-kafka/" 
       class="share-button" target="_blank" rel="noopener" aria-label="Share on Facebook">
      üìò Facebook
    </a>
    <button class="share-button" onclick="copyToClipboard('http://0.0.0.0:4001/2024/03/15/real-time-data-processing-kafka/')" aria-label="Copy link">
      üîó Copy Link
    </button>
  </div>

  <!-- AI-Powered Recommendations -->
  <div class="recommendations">
    <h3>Recommended for you</h3>
    <div class="recommended-posts">
      
      
      
      
        <div class="post-card">
          <div class="post-image">üí°</div>
          <h4><a href="/2024/12/25/agentic-ai-customer-service-automation/">Building an Agentic AI Customer Service System: A Complete Case Study</a></h4>
          <div class="post-meta">December 25, 2024</div>
          <div class="post-excerpt">How I built a multi-agent customer service system that reduced response time by 85% and improved satisfaction scores by 40%...</div>
        </div>
      
        <div class="post-card">
          <div class="post-image">üí°</div>
          <h4><a href="/2024/12/20/ai-powered-data-quality-monitoring/">AI-Powered Data Quality Monitoring: The Future of Data Reliability</a></h4>
          <div class="post-meta">December 20, 2024</div>
          <div class="post-excerpt">Discover how artificial intelligence is revolutionizing data quality monitoring with automated anomaly detection, intelligent alerting, and predictive data health insights....</div>
        </div>
      
        <div class="post-card">
          <div class="post-image">üí°</div>
          <h4><a href="/2024/12/15/advanced-kafka-streaming-patterns/">Advanced Kafka Streaming Patterns for Real-Time Analytics</a></h4>
          <div class="post-meta">December 15, 2024</div>
          <div class="post-excerpt">Explore advanced Apache Kafka streaming patterns including exactly-once processing, windowing operations, and complex event processing for building robust real-time analytics...</div>
        </div>
      
        <div class="post-card">
          <div class="post-image">üí°</div>
          <h4><a href="/2024/12/09/building-enterprise-ai-customer-support-system/">Building an Enterprise AI Customer Support System: From Concept to $485K Annual Savings</a></h4>
          <div class="post-meta">December 09, 2024</div>
          <div class="post-excerpt">How I built a Fortune 500-grade multi-agent customer support system using 100% free technologies, achieving 85% faster response times and...</div>
        </div>
      
        <div class="post-card">
          <div class="post-image">üí°</div>
          <h4><a href="/2024/04/15/mlops-deployment-strategies/">MLOps: Machine Learning Deployment Strategies</a></h4>
          <div class="post-meta">April 15, 2024</div>
          <div class="post-excerpt">MLOps: Machine Learning Deployment Strategies

</div>
        </div>
      
        <div class="post-card">
          <div class="post-image">üí°</div>
          <h4><a href="/2024/04/01/data-quality-monitoring-strategies/">Data Quality and Monitoring Strategies</a></h4>
          <div class="post-meta">April 01, 2024</div>
          <div class="post-excerpt">Data Quality and Monitoring Strategies

</div>
        </div>
      
        <div class="post-card">
          <div class="post-image">üí°</div>
          <h4><a href="/2024/03/01/building-modern-data-lakes/">Building Data Lakes with Modern Tools</a></h4>
          <div class="post-meta">March 01, 2024</div>
          <div class="post-excerpt">Learn how to design and implement modern data lake architectures using cloud technologies for scalable, cost-effective data storage and analytics....</div>
        </div>
      
        <div class="post-card">
          <div class="post-image">üí°</div>
          <h4><a href="/2024/02/15/apache-airflow-workflow-orchestration/">Setting up Apache Airflow for Workflow Orchestration</a></h4>
          <div class="post-meta">February 15, 2024</div>
          <div class="post-excerpt">Master Apache Airflow for building robust, scalable workflow orchestration systems with DAGs, scheduling, and monitoring capabilities.</div>
        </div>
      
        <div class="post-card">
          <div class="post-image">üí°</div>
          <h4><a href="/2024/02/01/building-data-pipelines-with-python/">Building Scalable Data Pipelines with Python</a></h4>
          <div class="post-meta">February 01, 2024</div>
          <div class="post-excerpt">Data pipelines are the backbone of any data-driven organization. Learn best practices for building robust and scalable data pipelines using...</div>
        </div>
      
        <div class="post-card">
          <div class="post-image">üí°</div>
          <h4><a href="/2024/01/15/welcome-to-my-blog/">Welcome to My Data Engineering Blog</a></h4>
          <div class="post-meta">January 15, 2024</div>
          <div class="post-excerpt">Hello and welcome to my blog! I'm excited to share my experiences and insights in the world of data engineering,...</div>
        </div>
      
    </div>
  </div>

  <!-- Comments Section -->
  
</article>

<script>
  function copyToClipboard(text) {
    navigator.clipboard.writeText(text).then(() => {
      alert('Link copied to clipboard!');
    });
  }
</script>
    </main>
    
    <!-- WhatsApp Chat Widget -->
    <div class="whatsapp-chat" id="whatsapp-chat">
        <div class="chat-bubble">
            <svg viewBox="0 0 24 24" fill="white">
                <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0020.885 3.488"/>
            </svg>
        </div>
        <div class="chat-tooltip">Chat with me on WhatsApp!</div>
    </div>

    <footer role="contentinfo">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h4>Connect</h4>
                    <div class="social-links">
                        <a href="https://github.com/niranjanagaram" aria-label="GitHub Profile">GitHub</a>
                        <a href="https://linkedin.com/in/niranjan-agaram" aria-label="LinkedIn Profile">LinkedIn</a>
                        <a href="mailto:niranjan@example.com" aria-label="Email Contact">Email</a>
                    </div>
                </div>
                <div class="footer-section">
                    <h4>Subscribe</h4>
                    <a href="/feed.xml" aria-label="RSS Feed">RSS Feed</a>
                </div>
            </div>
            <p>&copy; 2025 Niranjan's AI Insights. All rights reserved.</p>
        </div>
    </footer>
    
    <!-- Service Worker -->
    <script>
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('/sw.js');
        }
        
        // Modern Theme Toggle
        const themeToggle = document.getElementById('theme-toggle');
        const currentTheme = localStorage.getItem('theme') || 'dark';
        
        document.documentElement.setAttribute('data-theme', currentTheme);
        
        themeToggle.addEventListener('click', () => {
            const theme = document.documentElement.getAttribute('data-theme');
            const newTheme = theme === 'dark' ? 'light' : 'dark';
            document.documentElement.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
        });
        
        // Reading Progress
        window.addEventListener('scroll', () => {
            const progress = document.getElementById('reading-progress');
            const scrolled = (window.scrollY / (document.body.scrollHeight - window.innerHeight)) * 100;
            progress.style.width = scrolled + '%';
        });
        

    </script>
</body>
</html>